<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="500px" preserveAspectRatio="none" style="width:968px;height:500px;background:#FFFFFF;" version="1.1" viewBox="0 0 968 500" width="968px" zoomAndPan="magnify"><defs/><g><!--MD5=[2b7409a316d9d2e410653e6983353aed]
class Module--><g id="elem_Module"><rect codeLine="1" fill="#F1F1F1" height="48" id="Module" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="210" y="7"/><ellipse cx="225" cy="23" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M227.0781,24.8125 L227.4688,25.7969 L227.0781,25.7969 C226.625,25.7969 226.5156,25.8125 226.3594,25.9219 C226.1094,26.0781 225.9531,26.3594 225.9531,26.6563 C225.9531,26.9219 226.0938,27.1719 226.3125,27.3281 C226.4531,27.4531 226.6563,27.5 227.0781,27.5 L229.4375,27.5 C229.7969,27.5 230.0156,27.4688 230.1563,27.375 C230.4063,27.2344 230.5625,26.9375 230.5625,26.6563 C230.5625,26.375 230.4219,26.125 230.2031,25.9688 C230.0313,25.8281 229.875,25.7969 229.4063,25.7969 L226.0156,17.5938 L222.3438,17.5938 C221.8906,17.5938 221.7656,17.6094 221.6094,17.7031 C221.3594,17.875 221.2031,18.1563 221.2031,18.4375 C221.2031,18.7188 221.3438,18.9688 221.5625,19.1406 C221.7344,19.25 221.9063,19.2813 222.3438,19.2813 L223.4219,19.2813 L220.7813,25.7969 C220.3594,25.7969 220.2031,25.8125 220.0469,25.9219 C219.7969,26.0781 219.6406,26.3594 219.6406,26.6563 C219.6406,27.2188 220.0156,27.5 220.7656,27.5 L223.0313,27.5 C223.3906,27.5 223.6094,27.4688 223.7344,27.375 C224,27.2344 224.1406,26.9375 224.1406,26.6563 C224.1406,26.375 224.0156,26.125 223.7969,25.9531 C223.625,25.8281 223.4844,25.7969 223.0313,25.7969 L222.6406,25.7969 L223.0313,24.8125 L227.0781,24.8125 Z M226.375,23.1094 L223.7031,23.1094 L225.0469,19.8438 L226.375,23.1094 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="52" x="239" y="27.8467">Module</text><line style="stroke:#181818;stroke-width:0.5;" x1="211" x2="293" y1="39" y2="39"/><line style="stroke:#181818;stroke-width:0.5;" x1="211" x2="293" y1="47" y2="47"/></g><!--MD5=[a9c5adf0d69ef1b6045b65136973a6ef]
class NestingModule--><g id="elem_NestingModule"><rect codeLine="3" fill="#F1F1F1" height="96.8906" id="NestingModule" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="237" x="133.5" y="115"/><ellipse cx="195.25" cy="131" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M197.3281,132.8125 L197.7188,133.7969 L197.3281,133.7969 C196.875,133.7969 196.7656,133.8125 196.6094,133.9219 C196.3594,134.0781 196.2031,134.3594 196.2031,134.6563 C196.2031,134.9219 196.3438,135.1719 196.5625,135.3281 C196.7031,135.4531 196.9063,135.5 197.3281,135.5 L199.6875,135.5 C200.0469,135.5 200.2656,135.4688 200.4063,135.375 C200.6563,135.2344 200.8125,134.9375 200.8125,134.6563 C200.8125,134.375 200.6719,134.125 200.4531,133.9688 C200.2813,133.8281 200.125,133.7969 199.6563,133.7969 L196.2656,125.5938 L192.5938,125.5938 C192.1406,125.5938 192.0156,125.6094 191.8594,125.7031 C191.6094,125.875 191.4531,126.1563 191.4531,126.4375 C191.4531,126.7188 191.5938,126.9688 191.8125,127.1406 C191.9844,127.25 192.1563,127.2813 192.5938,127.2813 L193.6719,127.2813 L191.0313,133.7969 C190.6094,133.7969 190.4531,133.8125 190.2969,133.9219 C190.0469,134.0781 189.8906,134.3594 189.8906,134.6563 C189.8906,135.2188 190.2656,135.5 191.0156,135.5 L193.2813,135.5 C193.6406,135.5 193.8594,135.4688 193.9844,135.375 C194.25,135.2344 194.3906,134.9375 194.3906,134.6563 C194.3906,134.375 194.2656,134.125 194.0469,133.9531 C193.875,133.8281 193.7344,133.7969 193.2813,133.7969 L192.8906,133.7969 L193.2813,132.8125 L197.3281,132.8125 Z M196.625,131.1094 L193.9531,131.1094 L195.2969,127.8438 L196.625,131.1094 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="105" x="215.75" y="135.8467">NestingModule</text><line style="stroke:#181818;stroke-width:0.5;" x1="134.5" x2="369.5" y1="147" y2="147"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="139.5" y="163.9951">placeholders : List[Placeholder]</text><line style="stroke:#181818;stroke-width:1.0;" x1="134.5" x2="369.5" y1="171.2969" y2="171.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164" x="139.5" y="188.292">create_placeholder(...)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="139.5" y="204.5889">set_placeholders(...)</text></g><!--MD5=[ed563b05b877ef8d8db3538528b39a9d]
class Placeholder--><g id="elem_Placeholder"><rect codeLine="10" fill="#F1F1F1" height="80.5938" id="Placeholder" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="7" y="272"/><ellipse cx="22" cy="288" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M24.3438,283.6719 C23.4063,283.2344 22.8125,283.0938 21.9375,283.0938 C19.3125,283.0938 17.3125,285.1719 17.3125,287.8906 L17.3125,289.0156 C17.3125,291.5938 19.4219,293.4844 22.3125,293.4844 C23.5313,293.4844 24.6875,293.1875 25.4375,292.6406 C26.0156,292.2344 26.3438,291.7813 26.3438,291.3906 C26.3438,290.9375 25.9531,290.5469 25.4844,290.5469 C25.2656,290.5469 25.0625,290.625 24.875,290.8125 C24.4219,291.2969 24.4219,291.2969 24.2344,291.3906 C23.8125,291.6563 23.125,291.7813 22.3594,291.7813 C20.3125,291.7813 19.0156,290.6875 19.0156,288.9844 L19.0156,287.8906 C19.0156,286.1094 20.2656,284.7969 22,284.7969 C22.5781,284.7969 23.1875,284.9531 23.6563,285.2031 C24.1406,285.4844 24.3125,285.7031 24.4063,286.1094 C24.4688,286.5156 24.5,286.6406 24.6406,286.7656 C24.7813,286.9063 25.0156,287.0156 25.2344,287.0156 C25.5,287.0156 25.7656,286.875 25.9375,286.6563 C26.0469,286.5 26.0781,286.3125 26.0781,285.8906 L26.0781,284.4688 C26.0781,284.0313 26.0625,283.9063 25.9688,283.75 C25.8125,283.4844 25.5313,283.3438 25.2344,283.3438 C24.9375,283.3438 24.7344,283.4375 24.5156,283.75 L24.3438,283.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="36" y="292.8467">Placeholder</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="122" y1="304" y2="304"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="13" y="320.9951">input_ids</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="13" y="337.292">owner</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="122" y1="344.5938" y2="344.5938"/></g><!--MD5=[1894d99c1452aee8a36ae323ff2c2d44]
class LeafLayer--><g id="elem_LeafLayer"><rect codeLine="20" fill="#F1F1F1" height="64.2969" id="LeafLayer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="490" y="131.5"/><ellipse cx="536.75" cy="147.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M539.0938,143.1719 C538.1563,142.7344 537.5625,142.5938 536.6875,142.5938 C534.0625,142.5938 532.0625,144.6719 532.0625,147.3906 L532.0625,148.5156 C532.0625,151.0938 534.1719,152.9844 537.0625,152.9844 C538.2813,152.9844 539.4375,152.6875 540.1875,152.1406 C540.7656,151.7344 541.0938,151.2813 541.0938,150.8906 C541.0938,150.4375 540.7031,150.0469 540.2344,150.0469 C540.0156,150.0469 539.8125,150.125 539.625,150.3125 C539.1719,150.7969 539.1719,150.7969 538.9844,150.8906 C538.5625,151.1563 537.875,151.2813 537.1094,151.2813 C535.0625,151.2813 533.7656,150.1875 533.7656,148.4844 L533.7656,147.3906 C533.7656,145.6094 535.0156,144.2969 536.75,144.2969 C537.3281,144.2969 537.9375,144.4531 538.4063,144.7031 C538.8906,144.9844 539.0625,145.2031 539.1563,145.6094 C539.2188,146.0156 539.25,146.1406 539.3906,146.2656 C539.5313,146.4063 539.7656,146.5156 539.9844,146.5156 C540.25,146.5156 540.5156,146.375 540.6875,146.1563 C540.7969,146 540.8281,145.8125 540.8281,145.3906 L540.8281,143.9688 C540.8281,143.5313 540.8125,143.4063 540.7188,143.25 C540.5625,142.9844 540.2813,142.8438 539.9844,142.8438 C539.6875,142.8438 539.4844,142.9375 539.2656,143.25 L539.0938,143.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="557.25" y="152.3467">LeafLayer</text><line style="stroke:#181818;stroke-width:0.5;" x1="491" x2="661" y1="163.5" y2="163.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="496" y="180.4951">nodes : List[LeafNode]</text><line style="stroke:#181818;stroke-width:0.5;" x1="491" x2="661" y1="187.7969" y2="187.7969"/></g><!--MD5=[66148af4ccdef8153c55d160aebad70b]
class LeafNode--><g id="elem_LeafNode"><rect codeLine="24" fill="#F1F1F1" height="48" id="LeafNode" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="611" y="288.5"/><ellipse cx="626" cy="304.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M628.3438,300.1719 C627.4063,299.7344 626.8125,299.5938 625.9375,299.5938 C623.3125,299.5938 621.3125,301.6719 621.3125,304.3906 L621.3125,305.5156 C621.3125,308.0938 623.4219,309.9844 626.3125,309.9844 C627.5313,309.9844 628.6875,309.6875 629.4375,309.1406 C630.0156,308.7344 630.3438,308.2813 630.3438,307.8906 C630.3438,307.4375 629.9531,307.0469 629.4844,307.0469 C629.2656,307.0469 629.0625,307.125 628.875,307.3125 C628.4219,307.7969 628.4219,307.7969 628.2344,307.8906 C627.8125,308.1563 627.125,308.2813 626.3594,308.2813 C624.3125,308.2813 623.0156,307.1875 623.0156,305.4844 L623.0156,304.3906 C623.0156,302.6094 624.2656,301.2969 626,301.2969 C626.5781,301.2969 627.1875,301.4531 627.6563,301.7031 C628.1406,301.9844 628.3125,302.2031 628.4063,302.6094 C628.4688,303.0156 628.5,303.1406 628.6406,303.2656 C628.7813,303.4063 629.0156,303.5156 629.2344,303.5156 C629.5,303.5156 629.7656,303.375 629.9375,303.1563 C630.0469,303 630.0781,302.8125 630.0781,302.3906 L630.0781,300.9688 C630.0781,300.5313 630.0625,300.4063 629.9688,300.25 C629.8125,299.9844 629.5313,299.8438 629.2344,299.8438 C628.9375,299.8438 628.7344,299.9375 628.5156,300.25 L628.3438,300.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="640" y="309.3467">LeafNode</text><line style="stroke:#181818;stroke-width:0.5;" x1="612" x2="710" y1="320.5" y2="320.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="612" x2="710" y1="328.5" y2="328.5"/></g><!--MD5=[bece8b4c4229b3549b4a8159d27930ed]
class Scope--><g id="elem_Scope"><rect codeLine="29" fill="#F1F1F1" height="80.5938" id="Scope" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="223" x="555.5" y="413"/><ellipse cx="640.25" cy="429" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M642.5938,424.6719 C641.6563,424.2344 641.0625,424.0938 640.1875,424.0938 C637.5625,424.0938 635.5625,426.1719 635.5625,428.8906 L635.5625,430.0156 C635.5625,432.5938 637.6719,434.4844 640.5625,434.4844 C641.7813,434.4844 642.9375,434.1875 643.6875,433.6406 C644.2656,433.2344 644.5938,432.7813 644.5938,432.3906 C644.5938,431.9375 644.2031,431.5469 643.7344,431.5469 C643.5156,431.5469 643.3125,431.625 643.125,431.8125 C642.6719,432.2969 642.6719,432.2969 642.4844,432.3906 C642.0625,432.6563 641.375,432.7813 640.6094,432.7813 C638.5625,432.7813 637.2656,431.6875 637.2656,429.9844 L637.2656,428.8906 C637.2656,427.1094 638.5156,425.7969 640.25,425.7969 C640.8281,425.7969 641.4375,425.9531 641.9063,426.2031 C642.3906,426.4844 642.5625,426.7031 642.6563,427.1094 C642.7188,427.5156 642.75,427.6406 642.8906,427.7656 C643.0313,427.9063 643.2656,428.0156 643.4844,428.0156 C643.75,428.0156 644.0156,427.875 644.1875,427.6563 C644.2969,427.5 644.3281,427.3125 644.3281,426.8906 L644.3281,425.4688 C644.3281,425.0313 644.3125,424.9063 644.2188,424.75 C644.0625,424.4844 643.7813,424.3438 643.4844,424.3438 C643.1875,424.3438 642.9844,424.4375 642.7656,424.75 L642.5938,424.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="660.75" y="433.8467">Scope</text><line style="stroke:#181818;stroke-width:0.5;" x1="556.5" x2="777.5" y1="445" y2="445"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="561.5" y="461.9951">variables : Set[int]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211" x="561.5" y="478.292">network_type : NetworkType</text><line style="stroke:#181818;stroke-width:0.5;" x1="556.5" x2="777.5" y1="485.5938" y2="485.5938"/></g><!--MD5=[dcc2607c48d7949f71538576236c9492]
class NetworkType--><g id="elem_NetworkType"><rect codeLine="56" fill="#F1F1F1" height="48" id="NetworkType" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="781.5" y="288.5"/><ellipse cx="796.5" cy="304.5" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M798.5781,306.3125 L798.9688,307.2969 L798.5781,307.2969 C798.125,307.2969 798.0156,307.3125 797.8594,307.4219 C797.6094,307.5781 797.4531,307.8594 797.4531,308.1563 C797.4531,308.4219 797.5938,308.6719 797.8125,308.8281 C797.9531,308.9531 798.1563,309 798.5781,309 L800.9375,309 C801.2969,309 801.5156,308.9688 801.6563,308.875 C801.9063,308.7344 802.0625,308.4375 802.0625,308.1563 C802.0625,307.875 801.9219,307.625 801.7031,307.4688 C801.5313,307.3281 801.375,307.2969 800.9063,307.2969 L797.5156,299.0938 L793.8438,299.0938 C793.3906,299.0938 793.2656,299.1094 793.1094,299.2031 C792.8594,299.375 792.7031,299.6563 792.7031,299.9375 C792.7031,300.2188 792.8438,300.4688 793.0625,300.6406 C793.2344,300.75 793.4063,300.7813 793.8438,300.7813 L794.9219,300.7813 L792.2813,307.2969 C791.8594,307.2969 791.7031,307.3125 791.5469,307.4219 C791.2969,307.5781 791.1406,307.8594 791.1406,308.1563 C791.1406,308.7188 791.5156,309 792.2656,309 L794.5313,309 C794.8906,309 795.1094,308.9688 795.2344,308.875 C795.5,308.7344 795.6406,308.4375 795.6406,308.1563 C795.6406,307.875 795.5156,307.625 795.2969,307.4531 C795.125,307.3281 794.9844,307.2969 794.5313,307.2969 L794.1406,307.2969 L794.5313,306.3125 L798.5781,306.3125 Z M797.875,304.6094 L795.2031,304.6094 L796.5469,301.3438 L797.875,304.6094 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="93" x="810.5" y="309.3467">NetworkType</text><line style="stroke:#181818;stroke-width:0.5;" x1="782.5" x2="905.5" y1="320.5" y2="320.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="782.5" x2="905.5" y1="328.5" y2="328.5"/></g><!--MD5=[709978e0dc7aec016eb2a3d0ca5a9b5b]
class ProductLayer--><g id="elem_ProductLayer"><rect codeLine="38" fill="#F1F1F1" height="64.2969" id="ProductLayer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="197" x="158.5" y="280.5"/><ellipse cx="205.25" cy="296.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M207.5938,292.1719 C206.6563,291.7344 206.0625,291.5938 205.1875,291.5938 C202.5625,291.5938 200.5625,293.6719 200.5625,296.3906 L200.5625,297.5156 C200.5625,300.0938 202.6719,301.9844 205.5625,301.9844 C206.7813,301.9844 207.9375,301.6875 208.6875,301.1406 C209.2656,300.7344 209.5938,300.2813 209.5938,299.8906 C209.5938,299.4375 209.2031,299.0469 208.7344,299.0469 C208.5156,299.0469 208.3125,299.125 208.125,299.3125 C207.6719,299.7969 207.6719,299.7969 207.4844,299.8906 C207.0625,300.1563 206.375,300.2813 205.6094,300.2813 C203.5625,300.2813 202.2656,299.1875 202.2656,297.4844 L202.2656,296.3906 C202.2656,294.6094 203.5156,293.2969 205.25,293.2969 C205.8281,293.2969 206.4375,293.4531 206.9063,293.7031 C207.3906,293.9844 207.5625,294.2031 207.6563,294.6094 C207.7188,295.0156 207.75,295.1406 207.8906,295.2656 C208.0313,295.4063 208.2656,295.5156 208.4844,295.5156 C208.75,295.5156 209.0156,295.375 209.1875,295.1563 C209.2969,295 209.3281,294.8125 209.3281,294.3906 L209.3281,292.9688 C209.3281,292.5313 209.3125,292.4063 209.2188,292.25 C209.0625,291.9844 208.7813,291.8438 208.4844,291.8438 C208.1875,291.8438 207.9844,291.9375 207.7656,292.25 L207.5938,292.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="225.75" y="301.3467">ProductLayer</text><line style="stroke:#181818;stroke-width:0.5;" x1="159.5" x2="354.5" y1="312.5" y2="312.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="164.5" y="329.4951">nodes : List[ProductNode]</text><line style="stroke:#181818;stroke-width:0.5;" x1="159.5" x2="354.5" y1="336.7969" y2="336.7969"/></g><!--MD5=[066cb78d2b3541805f4aaffbc757a698]
class SumLayer--><g id="elem_SumLayer"><rect codeLine="42" fill="#F1F1F1" height="64.2969" id="SumLayer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="391" y="280.5"/><ellipse cx="437.75" cy="296.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M440.0938,292.1719 C439.1563,291.7344 438.5625,291.5938 437.6875,291.5938 C435.0625,291.5938 433.0625,293.6719 433.0625,296.3906 L433.0625,297.5156 C433.0625,300.0938 435.1719,301.9844 438.0625,301.9844 C439.2813,301.9844 440.4375,301.6875 441.1875,301.1406 C441.7656,300.7344 442.0938,300.2813 442.0938,299.8906 C442.0938,299.4375 441.7031,299.0469 441.2344,299.0469 C441.0156,299.0469 440.8125,299.125 440.625,299.3125 C440.1719,299.7969 440.1719,299.7969 439.9844,299.8906 C439.5625,300.1563 438.875,300.2813 438.1094,300.2813 C436.0625,300.2813 434.7656,299.1875 434.7656,297.4844 L434.7656,296.3906 C434.7656,294.6094 436.0156,293.2969 437.75,293.2969 C438.3281,293.2969 438.9375,293.4531 439.4063,293.7031 C439.8906,293.9844 440.0625,294.2031 440.1563,294.6094 C440.2188,295.0156 440.25,295.1406 440.3906,295.2656 C440.5313,295.4063 440.7656,295.5156 440.9844,295.5156 C441.25,295.5156 441.5156,295.375 441.6875,295.1563 C441.7969,295 441.8281,294.8125 441.8281,294.3906 L441.8281,292.9688 C441.8281,292.5313 441.8125,292.4063 441.7188,292.25 C441.5625,291.9844 441.2813,291.8438 440.9844,291.8438 C440.6875,291.8438 440.4844,291.9375 440.2656,292.25 L440.0938,292.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="458.25" y="301.3467">SumLayer</text><line style="stroke:#181818;stroke-width:0.5;" x1="392" x2="562" y1="312.5" y2="312.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="397" y="329.4951">nodes : List[SumNode]</text><line style="stroke:#181818;stroke-width:0.5;" x1="392" x2="562" y1="336.7969" y2="336.7969"/></g><!--MD5=[540ad19034418cbb219aa4b2bc3e4d03]
class SumNode--><g id="elem_SumNode"><rect codeLine="46" fill="#F1F1F1" height="48" id="SumNode" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="420" y="429.5"/><ellipse cx="435" cy="445.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M437.3438,441.1719 C436.4063,440.7344 435.8125,440.5938 434.9375,440.5938 C432.3125,440.5938 430.3125,442.6719 430.3125,445.3906 L430.3125,446.5156 C430.3125,449.0938 432.4219,450.9844 435.3125,450.9844 C436.5313,450.9844 437.6875,450.6875 438.4375,450.1406 C439.0156,449.7344 439.3438,449.2813 439.3438,448.8906 C439.3438,448.4375 438.9531,448.0469 438.4844,448.0469 C438.2656,448.0469 438.0625,448.125 437.875,448.3125 C437.4219,448.7969 437.4219,448.7969 437.2344,448.8906 C436.8125,449.1563 436.125,449.2813 435.3594,449.2813 C433.3125,449.2813 432.0156,448.1875 432.0156,446.4844 L432.0156,445.3906 C432.0156,443.6094 433.2656,442.2969 435,442.2969 C435.5781,442.2969 436.1875,442.4531 436.6563,442.7031 C437.1406,442.9844 437.3125,443.2031 437.4063,443.6094 C437.4688,444.0156 437.5,444.1406 437.6406,444.2656 C437.7813,444.4063 438.0156,444.5156 438.2344,444.5156 C438.5,444.5156 438.7656,444.375 438.9375,444.1563 C439.0469,444 439.0781,443.8125 439.0781,443.3906 L439.0781,441.9688 C439.0781,441.5313 439.0625,441.4063 438.9688,441.25 C438.8125,440.9844 438.5313,440.8438 438.2344,440.8438 C437.9375,440.8438 437.7344,440.9375 437.5156,441.25 L437.3438,441.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="449" y="450.3467">SumNode</text><line style="stroke:#181818;stroke-width:0.5;" x1="421" x2="519" y1="461.5" y2="461.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="421" x2="519" y1="469.5" y2="469.5"/></g><!--MD5=[de66e0bf3b5cf0679d45b5a314dc41c5]
class ProductNode--><g id="elem_ProductNode"><rect codeLine="51" fill="#F1F1F1" height="48" id="ProductNode" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="194.5" y="429.5"/><ellipse cx="209.5" cy="445.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M211.8438,441.1719 C210.9063,440.7344 210.3125,440.5938 209.4375,440.5938 C206.8125,440.5938 204.8125,442.6719 204.8125,445.3906 L204.8125,446.5156 C204.8125,449.0938 206.9219,450.9844 209.8125,450.9844 C211.0313,450.9844 212.1875,450.6875 212.9375,450.1406 C213.5156,449.7344 213.8438,449.2813 213.8438,448.8906 C213.8438,448.4375 213.4531,448.0469 212.9844,448.0469 C212.7656,448.0469 212.5625,448.125 212.375,448.3125 C211.9219,448.7969 211.9219,448.7969 211.7344,448.8906 C211.3125,449.1563 210.625,449.2813 209.8594,449.2813 C207.8125,449.2813 206.5156,448.1875 206.5156,446.4844 L206.5156,445.3906 C206.5156,443.6094 207.7656,442.2969 209.5,442.2969 C210.0781,442.2969 210.6875,442.4531 211.1563,442.7031 C211.6406,442.9844 211.8125,443.2031 211.9063,443.6094 C211.9688,444.0156 212,444.1406 212.1406,444.2656 C212.2813,444.4063 212.5156,444.5156 212.7344,444.5156 C213,444.5156 213.2656,444.375 213.4375,444.1563 C213.5469,444 213.5781,443.8125 213.5781,443.3906 L213.5781,441.9688 C213.5781,441.5313 213.5625,441.4063 213.4688,441.25 C213.3125,440.9844 213.0313,440.8438 212.7344,440.8438 C212.4375,440.8438 212.2344,440.9375 212.0156,441.25 L211.8438,441.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="223.5" y="450.3467">ProductNode</text><line style="stroke:#181818;stroke-width:0.5;" x1="195.5" x2="318.5" y1="461.5" y2="461.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="195.5" x2="318.5" y1="469.5" y2="469.5"/></g><!--MD5=[0417168d75c47ce8d429e9f7d7ecdd1e]
class SPN--><g id="elem_SPN"><rect fill="#F1F1F1" height="48" id="SPN" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="814" y="429.5"/><ellipse cx="829" cy="445.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M831.3438,441.1719 C830.4063,440.7344 829.8125,440.5938 828.9375,440.5938 C826.3125,440.5938 824.3125,442.6719 824.3125,445.3906 L824.3125,446.5156 C824.3125,449.0938 826.4219,450.9844 829.3125,450.9844 C830.5313,450.9844 831.6875,450.6875 832.4375,450.1406 C833.0156,449.7344 833.3438,449.2813 833.3438,448.8906 C833.3438,448.4375 832.9531,448.0469 832.4844,448.0469 C832.2656,448.0469 832.0625,448.125 831.875,448.3125 C831.4219,448.7969 831.4219,448.7969 831.2344,448.8906 C830.8125,449.1563 830.125,449.2813 829.3594,449.2813 C827.3125,449.2813 826.0156,448.1875 826.0156,446.4844 L826.0156,445.3906 C826.0156,443.6094 827.2656,442.2969 829,442.2969 C829.5781,442.2969 830.1875,442.4531 830.6563,442.7031 C831.1406,442.9844 831.3125,443.2031 831.4063,443.6094 C831.4688,444.0156 831.5,444.1406 831.6406,444.2656 C831.7813,444.4063 832.0156,444.5156 832.2344,444.5156 C832.5,444.5156 832.7656,444.375 832.9375,444.1563 C833.0469,444 833.0781,443.8125 833.0781,443.3906 L833.0781,441.9688 C833.0781,441.5313 833.0625,441.4063 832.9688,441.25 C832.8125,440.9844 832.5313,440.8438 832.2344,440.8438 C831.9375,440.8438 831.7344,440.9375 831.5156,441.25 L831.3438,441.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="843" y="450.3467">SPN</text><line style="stroke:#181818;stroke-width:0.5;" x1="815" x2="873" y1="461.5" y2="461.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="815" x2="873" y1="469.5" y2="469.5"/></g><!--MD5=[2ae4bcd515457a80f1b14dd6bd1171b4]
class BN--><g id="elem_BN"><rect fill="#F1F1F1" height="48" id="BN" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="909" y="429.5"/><ellipse cx="924" cy="445.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M926.3438,441.1719 C925.4063,440.7344 924.8125,440.5938 923.9375,440.5938 C921.3125,440.5938 919.3125,442.6719 919.3125,445.3906 L919.3125,446.5156 C919.3125,449.0938 921.4219,450.9844 924.3125,450.9844 C925.5313,450.9844 926.6875,450.6875 927.4375,450.1406 C928.0156,449.7344 928.3438,449.2813 928.3438,448.8906 C928.3438,448.4375 927.9531,448.0469 927.4844,448.0469 C927.2656,448.0469 927.0625,448.125 926.875,448.3125 C926.4219,448.7969 926.4219,448.7969 926.2344,448.8906 C925.8125,449.1563 925.125,449.2813 924.3594,449.2813 C922.3125,449.2813 921.0156,448.1875 921.0156,446.4844 L921.0156,445.3906 C921.0156,443.6094 922.2656,442.2969 924,442.2969 C924.5781,442.2969 925.1875,442.4531 925.6563,442.7031 C926.1406,442.9844 926.3125,443.2031 926.4063,443.6094 C926.4688,444.0156 926.5,444.1406 926.6406,444.2656 C926.7813,444.4063 927.0156,444.5156 927.2344,444.5156 C927.5,444.5156 927.7656,444.375 927.9375,444.1563 C928.0469,444 928.0781,443.8125 928.0781,443.3906 L928.0781,441.9688 C928.0781,441.5313 928.0625,441.4063 927.9688,441.25 C927.8125,440.9844 927.5313,440.8438 927.2344,440.8438 C926.9375,440.8438 926.7344,440.9375 926.5156,441.25 L926.3438,441.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20" x="938" y="450.3467">BN</text><line style="stroke:#181818;stroke-width:0.5;" x1="910" x2="960" y1="461.5" y2="461.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="910" x2="960" y1="469.5" y2="469.5"/></g><!--MD5=[fea0c87994cc0e6cff7f375e4fbefb9e]
reverse link Module to NestingModule--><g id="link_Module_NestingModule"><path codeLine="15" d="M252,75.375 C252,88.033 252,101.934 252,114.843 " fill="none" id="Module-backto-NestingModule" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="245,75.03,252,55.03,259,75.03,245,75.03" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4982a4d849352280d5237884273d8fd1]
reverse link Module to Placeholder--><g id="link_Module_Placeholder"><path codeLine="16" d="M191.644,56.188 C164.854,69.764 135.126,89.225 116,115 C81.4508,161.559 70.2445,229.419 66.6474,271.98 " fill="none" id="Module-backto-Placeholder" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="188.92,49.733,209.995,47.531,194.893,62.395,188.92,49.733" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a103b1852e3e4994c1d924981decf2f9]
reverse link NestingModule to Placeholder--><g id="link_NestingModule_Placeholder"><path codeLine="17" d="M167.365,221.244 C145.292,238.114 122.576,256.228 104.0728,271.769 " fill="none" id="NestingModule-backto-Placeholder" style="stroke:#181818;stroke-width:1.0;"/><ellipse cx="173.1552" cy="216.8561" fill="#FFFFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="166.7794" x2="179.531" y1="221.6882" y2="212.024"/><line style="stroke:#181818;stroke-width:1.0;" x1="168.3231" x2="177.9873" y1="210.4803" y2="223.2319"/></g><!--MD5=[527b40695e3941cfb2eaf25170657751]
link NestingModule to Placeholder--><g id="link_NestingModule_Placeholder"><path codeLine="18" d="M204.02,212.227 C180.618,231.564 152.348,253.625 127.328,272.033 " fill="none" id="NestingModule-to-Placeholder" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="123.02,275.189,132.6442,273.0972,127.0535,272.2342,127.9165,266.6436,123.02,275.189" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[11593aeea67b481ea398fcb3e5814276]
reverse link Module to LeafLayer--><g id="link_Module_LeafLayer"><path codeLine="26" d="M312.622,56.417 C365.333,77.648 441.986,108.522 499.02,131.494 " fill="none" id="Module-backto-LeafLayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="309.962,62.892,294.025,48.927,315.192,49.906,309.962,62.892" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a5abba92ddf5fdafee846c7905d3cd4a]
link LeafLayer to LeafNode--><g id="link_LeafLayer_LeafNode"><path codeLine="27" d="M594.026,195.675 C609.074,221.698 630.331,258.46 644.834,283.543 " fill="none" id="LeafLayer-to-LeafNode" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="647.461,288.086,646.4187,278.2924,644.9582,283.7575,639.4931,282.297,647.461,288.086" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[998bb52771b8a2acef896b4427a515c3]
reverse link NetworkType to Scope--><g id="link_NetworkType_Scope"><path codeLine="34" d="M810.26,339.996 C784.044,360.584 747.267,389.466 717.54,412.8106 " fill="none" id="NetworkType-backto-Scope" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="814.374,336.765,804.8253,339.1778,810.4417,339.8532,809.7663,345.4696,814.374,336.765" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c0c3b8cc5a68f06c53818c23e5d6de4d]
link LeafNode to Scope--><g id="link_LeafNode_Scope"><path codeLine="36" d="M662.004,336.765 C662.835,356.022 664.041,383.944 665.059,407.5373 " fill="none" id="LeafNode-to-Scope" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="665.287,412.8106,668.8949,403.6464,665.0712,407.8153,660.9024,403.9916,665.287,412.8106" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[18aec7f8dab732d70d30b54687f2ccf3]
reverse link NestingModule to SumLayer--><g id="link_NestingModule_SumLayer"><path codeLine="48" d="M341.584,223.028 C371.567,242.617 403.818,263.688 429.323,280.351 " fill="none" id="NestingModule-backto-SumLayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="337.655,228.823,324.74,212.024,345.312,217.103,337.655,228.823" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bc62471d8c6f7411bee3e776944a3a3e]
link SumLayer to SumNode--><g id="link_SumLayer_SumNode"><path codeLine="49" d="M475.429,344.694 C474.23,368.507 472.591,401.0446 471.429,424.128 " fill="none" id="SumLayer-to-SumNode" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="471.174,429.1954,475.6217,420.408,471.4255,424.2017,467.6318,420.0056,471.174,429.1954" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f42027253c9129ef76a4b547e1afd213]
reverse link NestingModule to ProductLayer--><g id="link_NestingModule_ProductLayer"><path codeLine="53" d="M254.304,232.237 C254.874,248.999 255.458,266.163 255.936,280.214 " fill="none" id="NestingModule-backto-ProductLayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="247.307,232.453,253.623,212.227,261.299,231.977,247.307,232.453" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[468399379625fa666059c49bac5099cc]
link ProductLayer to ProductNode--><g id="link_ProductLayer_ProductNode"><path codeLine="54" d="M257,344.694 C257,368.507 257,401.0446 257,424.128 " fill="none" id="ProductLayer-to-ProductNode" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="257,429.1954,261,420.1954,257,424.1954,253,420.1954,257,429.1954" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a0f50d086a4fc67c74a8886285c4ee65]
reverse link NetworkType to SPN--><g id="link_NetworkType_SPN"><path codeLine="57" d="M844,356.947 C844,380.821 844,409.4906 844,429.1586 " fill="none" id="NetworkType-backto-SPN" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="837,356.766,844,336.765,851,356.765,837,356.766" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8b3aa38a98d708493ec55897aeda3456]
reverse link NetworkType to BN--><g id="link_NetworkType_BN"><path codeLine="58" d="M870.311,353.689 C886.337,378.169 906.251,408.5874 919.719,429.1586 " fill="none" id="NetworkType-backto-BN" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="864.33,357.333,859.231,336.765,876.043,349.664,864.33,357.333" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bcdad8cc2be2b5273ddae6259d8086e0]
@startuml
abstract class Module

abstract class NestingModule {
  placeholders : List[Placeholder]
  - - -
  create_placeholder(...)
  set_placeholders(...)
}

class Placeholder {
  input_ids
  owner
}

Module <|- - NestingModule
Module <|- - Placeholder
NestingModule +- - Placeholder
NestingModule - -> Placeholder

class LeafLayer {
  nodes : List[LeafNode]
}

class LeafNode

Module <|- - LeafLayer
LeafLayer - -> LeafNode

class Scope {
  variables : Set[int]
  network_type : NetworkType
}

NetworkType <- - Scope

LeafNode - -> Scope

class ProductLayer {
  nodes : List[ProductNode]
}

class SumLayer {
  nodes : List[SumNode]
}

class SumNode

NestingModule <|- - SumLayer
SumLayer - -> SumNode

class ProductNode

NestingModule <|- - ProductLayer
ProductLayer - -> ProductNode

abstract class  NetworkType
NetworkType <|- - SPN
NetworkType <|- - BN
@enduml

PlantUML version 1.2022.3beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>