<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="535px" preserveAspectRatio="none" style="width:1326px;height:535px;background:#FFFFFF;" version="1.1" viewBox="0 0 1326 535" width="1326px" zoomAndPan="magnify"><defs/><g><!--MD5=[2b7409a316d9d2e410653e6983353aed]
class Module--><g id="elem_Module"><rect codeLine="46" fill="#F1F1F1" height="48" id="Module" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="573.5" y="7"/><ellipse cx="588.5" cy="23" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M590.5781,24.8125 L590.9688,25.7969 L590.5781,25.7969 C590.125,25.7969 590.0156,25.8125 589.8594,25.9219 C589.6094,26.0781 589.4531,26.3594 589.4531,26.6563 C589.4531,26.9219 589.5938,27.1719 589.8125,27.3281 C589.9531,27.4531 590.1563,27.5 590.5781,27.5 L592.9375,27.5 C593.2969,27.5 593.5156,27.4688 593.6563,27.375 C593.9063,27.2344 594.0625,26.9375 594.0625,26.6563 C594.0625,26.375 593.9219,26.125 593.7031,25.9688 C593.5313,25.8281 593.375,25.7969 592.9063,25.7969 L589.5156,17.5938 L585.8438,17.5938 C585.3906,17.5938 585.2656,17.6094 585.1094,17.7031 C584.8594,17.875 584.7031,18.1563 584.7031,18.4375 C584.7031,18.7188 584.8438,18.9688 585.0625,19.1406 C585.2344,19.25 585.4063,19.2813 585.8438,19.2813 L586.9219,19.2813 L584.2813,25.7969 C583.8594,25.7969 583.7031,25.8125 583.5469,25.9219 C583.2969,26.0781 583.1406,26.3594 583.1406,26.6563 C583.1406,27.2188 583.5156,27.5 584.2656,27.5 L586.5313,27.5 C586.8906,27.5 587.1094,27.4688 587.2344,27.375 C587.5,27.2344 587.6406,26.9375 587.6406,26.6563 C587.6406,26.375 587.5156,26.125 587.2969,25.9531 C587.125,25.8281 586.9844,25.7969 586.5313,25.7969 L586.1406,25.7969 L586.5313,24.8125 L590.5781,24.8125 Z M589.875,23.1094 L587.2031,23.1094 L588.5469,19.8438 L589.875,23.1094 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="52" x="602.5" y="27.8467">Module</text><line style="stroke:#181818;stroke-width:0.5;" x1="574.5" x2="656.5" y1="39" y2="39"/><line style="stroke:#181818;stroke-width:0.5;" x1="574.5" x2="656.5" y1="47" y2="47"/></g><!--MD5=[a9c5adf0d69ef1b6045b65136973a6ef]
class NestingModule--><g id="elem_NestingModule"><rect codeLine="3" fill="#F1F1F1" height="96.8906" id="NestingModule" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="237" x="254" y="116"/><ellipse cx="315.75" cy="132" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M317.8281,133.8125 L318.2188,134.7969 L317.8281,134.7969 C317.375,134.7969 317.2656,134.8125 317.1094,134.9219 C316.8594,135.0781 316.7031,135.3594 316.7031,135.6563 C316.7031,135.9219 316.8438,136.1719 317.0625,136.3281 C317.2031,136.4531 317.4063,136.5 317.8281,136.5 L320.1875,136.5 C320.5469,136.5 320.7656,136.4688 320.9063,136.375 C321.1563,136.2344 321.3125,135.9375 321.3125,135.6563 C321.3125,135.375 321.1719,135.125 320.9531,134.9688 C320.7813,134.8281 320.625,134.7969 320.1563,134.7969 L316.7656,126.5938 L313.0938,126.5938 C312.6406,126.5938 312.5156,126.6094 312.3594,126.7031 C312.1094,126.875 311.9531,127.1563 311.9531,127.4375 C311.9531,127.7188 312.0938,127.9688 312.3125,128.1406 C312.4844,128.25 312.6563,128.2813 313.0938,128.2813 L314.1719,128.2813 L311.5313,134.7969 C311.1094,134.7969 310.9531,134.8125 310.7969,134.9219 C310.5469,135.0781 310.3906,135.3594 310.3906,135.6563 C310.3906,136.2188 310.7656,136.5 311.5156,136.5 L313.7813,136.5 C314.1406,136.5 314.3594,136.4688 314.4844,136.375 C314.75,136.2344 314.8906,135.9375 314.8906,135.6563 C314.8906,135.375 314.7656,135.125 314.5469,134.9531 C314.375,134.8281 314.2344,134.7969 313.7813,134.7969 L313.3906,134.7969 L313.7813,133.8125 L317.8281,133.8125 Z M317.125,132.1094 L314.4531,132.1094 L315.7969,128.8438 L317.125,132.1094 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="105" x="336.25" y="136.8467">NestingModule</text><line style="stroke:#181818;stroke-width:0.5;" x1="255" x2="490" y1="148" y2="148"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="260" y="164.9951">placeholders : List[Placeholder]</text><line style="stroke:#181818;stroke-width:1.0;" x1="255" x2="490" y1="172.2969" y2="172.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164" x="260" y="189.292">create_placeholder(...)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="260" y="205.5889">set_placeholders(...)</text></g><!--MD5=[ed563b05b877ef8d8db3538528b39a9d]
class Placeholder--><g id="elem_Placeholder"><rect codeLine="10" fill="#F1F1F1" height="80.5938" id="Placeholder" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="446.5" y="298"/><ellipse cx="461.5" cy="314" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M463.8438,309.6719 C462.9063,309.2344 462.3125,309.0938 461.4375,309.0938 C458.8125,309.0938 456.8125,311.1719 456.8125,313.8906 L456.8125,315.0156 C456.8125,317.5938 458.9219,319.4844 461.8125,319.4844 C463.0313,319.4844 464.1875,319.1875 464.9375,318.6406 C465.5156,318.2344 465.8438,317.7813 465.8438,317.3906 C465.8438,316.9375 465.4531,316.5469 464.9844,316.5469 C464.7656,316.5469 464.5625,316.625 464.375,316.8125 C463.9219,317.2969 463.9219,317.2969 463.7344,317.3906 C463.3125,317.6563 462.625,317.7813 461.8594,317.7813 C459.8125,317.7813 458.5156,316.6875 458.5156,314.9844 L458.5156,313.8906 C458.5156,312.1094 459.7656,310.7969 461.5,310.7969 C462.0781,310.7969 462.6875,310.9531 463.1563,311.2031 C463.6406,311.4844 463.8125,311.7031 463.9063,312.1094 C463.9688,312.5156 464,312.6406 464.1406,312.7656 C464.2813,312.9063 464.5156,313.0156 464.7344,313.0156 C465,313.0156 465.2656,312.875 465.4375,312.6563 C465.5469,312.5 465.5781,312.3125 465.5781,311.8906 L465.5781,310.4688 C465.5781,310.0313 465.5625,309.9063 465.4688,309.75 C465.3125,309.4844 465.0313,309.3438 464.7344,309.3438 C464.4375,309.3438 464.2344,309.4375 464.0156,309.75 L463.8438,309.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="475.5" y="318.8467">Placeholder</text><line style="stroke:#181818;stroke-width:0.5;" x1="447.5" x2="561.5" y1="330" y2="330"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="452.5" y="346.9951">input_ids</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="452.5" y="363.292">owner</text><line style="stroke:#181818;stroke-width:0.5;" x1="447.5" x2="561.5" y1="370.5938" y2="370.5938"/></g><!--MD5=[1894d99c1452aee8a36ae323ff2c2d44]
class LeafLayer--><g id="elem_LeafLayer"><rect codeLine="20" fill="#F1F1F1" height="64.2969" id="LeafLayer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="876.5" y="132.5"/><ellipse cx="923.25" cy="148.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M925.5938,144.1719 C924.6563,143.7344 924.0625,143.5938 923.1875,143.5938 C920.5625,143.5938 918.5625,145.6719 918.5625,148.3906 L918.5625,149.5156 C918.5625,152.0938 920.6719,153.9844 923.5625,153.9844 C924.7813,153.9844 925.9375,153.6875 926.6875,153.1406 C927.2656,152.7344 927.5938,152.2813 927.5938,151.8906 C927.5938,151.4375 927.2031,151.0469 926.7344,151.0469 C926.5156,151.0469 926.3125,151.125 926.125,151.3125 C925.6719,151.7969 925.6719,151.7969 925.4844,151.8906 C925.0625,152.1563 924.375,152.2813 923.6094,152.2813 C921.5625,152.2813 920.2656,151.1875 920.2656,149.4844 L920.2656,148.3906 C920.2656,146.6094 921.5156,145.2969 923.25,145.2969 C923.8281,145.2969 924.4375,145.4531 924.9063,145.7031 C925.3906,145.9844 925.5625,146.2031 925.6563,146.6094 C925.7188,147.0156 925.75,147.1406 925.8906,147.2656 C926.0313,147.4063 926.2656,147.5156 926.4844,147.5156 C926.75,147.5156 927.0156,147.375 927.1875,147.1563 C927.2969,147 927.3281,146.8125 927.3281,146.3906 L927.3281,144.9688 C927.3281,144.5313 927.3125,144.4063 927.2188,144.25 C927.0625,143.9844 926.7813,143.8438 926.4844,143.8438 C926.1875,143.8438 925.9844,143.9375 925.7656,144.25 L925.5938,144.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="943.75" y="153.3467">LeafLayer</text><line style="stroke:#181818;stroke-width:0.5;" x1="877.5" x2="1047.5" y1="164.5" y2="164.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="882.5" y="181.4951">nodes : List[LeafNode]</text><line style="stroke:#181818;stroke-width:0.5;" x1="877.5" x2="1047.5" y1="188.7969" y2="188.7969"/></g><!--MD5=[66148af4ccdef8153c55d160aebad70b]
class LeafNode--><g id="elem_LeafNode"><rect codeLine="24" fill="#F1F1F1" height="48" id="LeafNode" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="975.5" y="314.5"/><ellipse cx="990.5" cy="330.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M992.8438,326.1719 C991.9063,325.7344 991.3125,325.5938 990.4375,325.5938 C987.8125,325.5938 985.8125,327.6719 985.8125,330.3906 L985.8125,331.5156 C985.8125,334.0938 987.9219,335.9844 990.8125,335.9844 C992.0313,335.9844 993.1875,335.6875 993.9375,335.1406 C994.5156,334.7344 994.8438,334.2813 994.8438,333.8906 C994.8438,333.4375 994.4531,333.0469 993.9844,333.0469 C993.7656,333.0469 993.5625,333.125 993.375,333.3125 C992.9219,333.7969 992.9219,333.7969 992.7344,333.8906 C992.3125,334.1563 991.625,334.2813 990.8594,334.2813 C988.8125,334.2813 987.5156,333.1875 987.5156,331.4844 L987.5156,330.3906 C987.5156,328.6094 988.7656,327.2969 990.5,327.2969 C991.0781,327.2969 991.6875,327.4531 992.1563,327.7031 C992.6406,327.9844 992.8125,328.2031 992.9063,328.6094 C992.9688,329.0156 993,329.1406 993.1406,329.2656 C993.2813,329.4063 993.5156,329.5156 993.7344,329.5156 C994,329.5156 994.2656,329.375 994.4375,329.1563 C994.5469,329 994.5781,328.8125 994.5781,328.3906 L994.5781,326.9688 C994.5781,326.5313 994.5625,326.4063 994.4688,326.25 C994.3125,325.9844 994.0313,325.8438 993.7344,325.8438 C993.4375,325.8438 993.2344,325.9375 993.0156,326.25 L992.8438,326.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="1004.5" y="335.3467">LeafNode</text><line style="stroke:#181818;stroke-width:0.5;" x1="976.5" x2="1074.5" y1="346.5" y2="346.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="976.5" x2="1074.5" y1="354.5" y2="354.5"/></g><!--MD5=[bece8b4c4229b3549b4a8159d27930ed]
class Scope--><g id="elem_Scope"><rect codeLine="29" fill="#F1F1F1" height="80.5938" id="Scope" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="223" x="914" y="448"/><ellipse cx="998.75" cy="464" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1001.0938,459.6719 C1000.1563,459.2344 999.5625,459.0938 998.6875,459.0938 C996.0625,459.0938 994.0625,461.1719 994.0625,463.8906 L994.0625,465.0156 C994.0625,467.5938 996.1719,469.4844 999.0625,469.4844 C1000.2813,469.4844 1001.4375,469.1875 1002.1875,468.6406 C1002.7656,468.2344 1003.0938,467.7813 1003.0938,467.3906 C1003.0938,466.9375 1002.7031,466.5469 1002.2344,466.5469 C1002.0156,466.5469 1001.8125,466.625 1001.625,466.8125 C1001.1719,467.2969 1001.1719,467.2969 1000.9844,467.3906 C1000.5625,467.6563 999.875,467.7813 999.1094,467.7813 C997.0625,467.7813 995.7656,466.6875 995.7656,464.9844 L995.7656,463.8906 C995.7656,462.1094 997.0156,460.7969 998.75,460.7969 C999.3281,460.7969 999.9375,460.9531 1000.4063,461.2031 C1000.8906,461.4844 1001.0625,461.7031 1001.1563,462.1094 C1001.2188,462.5156 1001.25,462.6406 1001.3906,462.7656 C1001.5313,462.9063 1001.7656,463.0156 1001.9844,463.0156 C1002.25,463.0156 1002.5156,462.875 1002.6875,462.6563 C1002.7969,462.5 1002.8281,462.3125 1002.8281,461.8906 L1002.8281,460.4688 C1002.8281,460.0313 1002.8125,459.9063 1002.7188,459.75 C1002.5625,459.4844 1002.2813,459.3438 1001.9844,459.3438 C1001.6875,459.3438 1001.4844,459.4375 1001.2656,459.75 L1001.0938,459.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="1019.25" y="468.8467">Scope</text><line style="stroke:#181818;stroke-width:0.5;" x1="915" x2="1136" y1="480" y2="480"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="920" y="496.9951">variables : Set[int]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="211" x="920" y="513.292">network_type : NetworkType</text><line style="stroke:#181818;stroke-width:0.5;" x1="915" x2="1136" y1="520.5938" y2="520.5938"/></g><!--MD5=[dcc2607c48d7949f71538576236c9492]
class NetworkType--><g id="elem_NetworkType"><rect codeLine="73" fill="#F1F1F1" height="48" id="NetworkType" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="1136" y="314.5"/><ellipse cx="1151" cy="330.5" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1153.0781,332.3125 L1153.4688,333.2969 L1153.0781,333.2969 C1152.625,333.2969 1152.5156,333.3125 1152.3594,333.4219 C1152.1094,333.5781 1151.9531,333.8594 1151.9531,334.1563 C1151.9531,334.4219 1152.0938,334.6719 1152.3125,334.8281 C1152.4531,334.9531 1152.6563,335 1153.0781,335 L1155.4375,335 C1155.7969,335 1156.0156,334.9688 1156.1563,334.875 C1156.4063,334.7344 1156.5625,334.4375 1156.5625,334.1563 C1156.5625,333.875 1156.4219,333.625 1156.2031,333.4688 C1156.0313,333.3281 1155.875,333.2969 1155.4063,333.2969 L1152.0156,325.0938 L1148.3438,325.0938 C1147.8906,325.0938 1147.7656,325.1094 1147.6094,325.2031 C1147.3594,325.375 1147.2031,325.6563 1147.2031,325.9375 C1147.2031,326.2188 1147.3438,326.4688 1147.5625,326.6406 C1147.7344,326.75 1147.9063,326.7813 1148.3438,326.7813 L1149.4219,326.7813 L1146.7813,333.2969 C1146.3594,333.2969 1146.2031,333.3125 1146.0469,333.4219 C1145.7969,333.5781 1145.6406,333.8594 1145.6406,334.1563 C1145.6406,334.7188 1146.0156,335 1146.7656,335 L1149.0313,335 C1149.3906,335 1149.6094,334.9688 1149.7344,334.875 C1150,334.7344 1150.1406,334.4375 1150.1406,334.1563 C1150.1406,333.875 1150.0156,333.625 1149.7969,333.4531 C1149.625,333.3281 1149.4844,333.2969 1149.0313,333.2969 L1148.6406,333.2969 L1149.0313,332.3125 L1153.0781,332.3125 Z M1152.375,330.6094 L1149.7031,330.6094 L1151.0469,327.3438 L1152.375,330.6094 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="93" x="1165" y="335.3467">NetworkType</text><line style="stroke:#181818;stroke-width:0.5;" x1="1137" x2="1260" y1="346.5" y2="346.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1137" x2="1260" y1="354.5" y2="354.5"/></g><!--MD5=[709978e0dc7aec016eb2a3d0ca5a9b5b]
class ProductLayer--><g id="elem_ProductLayer"><rect codeLine="38" fill="#F1F1F1" height="64.2969" id="ProductLayer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="197" x="7" y="306.5"/><ellipse cx="53.75" cy="322.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M56.0938,318.1719 C55.1563,317.7344 54.5625,317.5938 53.6875,317.5938 C51.0625,317.5938 49.0625,319.6719 49.0625,322.3906 L49.0625,323.5156 C49.0625,326.0938 51.1719,327.9844 54.0625,327.9844 C55.2813,327.9844 56.4375,327.6875 57.1875,327.1406 C57.7656,326.7344 58.0938,326.2813 58.0938,325.8906 C58.0938,325.4375 57.7031,325.0469 57.2344,325.0469 C57.0156,325.0469 56.8125,325.125 56.625,325.3125 C56.1719,325.7969 56.1719,325.7969 55.9844,325.8906 C55.5625,326.1563 54.875,326.2813 54.1094,326.2813 C52.0625,326.2813 50.7656,325.1875 50.7656,323.4844 L50.7656,322.3906 C50.7656,320.6094 52.0156,319.2969 53.75,319.2969 C54.3281,319.2969 54.9375,319.4531 55.4063,319.7031 C55.8906,319.9844 56.0625,320.2031 56.1563,320.6094 C56.2188,321.0156 56.25,321.1406 56.3906,321.2656 C56.5313,321.4063 56.7656,321.5156 56.9844,321.5156 C57.25,321.5156 57.5156,321.375 57.6875,321.1563 C57.7969,321 57.8281,320.8125 57.8281,320.3906 L57.8281,318.9688 C57.8281,318.5313 57.8125,318.4063 57.7188,318.25 C57.5625,317.9844 57.2813,317.8438 56.9844,317.8438 C56.6875,317.8438 56.4844,317.9375 56.2656,318.25 L56.0938,318.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="74.25" y="327.3467">ProductLayer</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="203" y1="338.5" y2="338.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="13" y="355.4951">nodes : List[ProductNode]</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="203" y1="362.7969" y2="362.7969"/></g><!--MD5=[066cb78d2b3541805f4aaffbc757a698]
class SumLayer--><g id="elem_SumLayer"><rect codeLine="42" fill="#F1F1F1" height="64.2969" id="SumLayer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="239.5" y="306.5"/><ellipse cx="286.25" cy="322.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M288.5938,318.1719 C287.6563,317.7344 287.0625,317.5938 286.1875,317.5938 C283.5625,317.5938 281.5625,319.6719 281.5625,322.3906 L281.5625,323.5156 C281.5625,326.0938 283.6719,327.9844 286.5625,327.9844 C287.7813,327.9844 288.9375,327.6875 289.6875,327.1406 C290.2656,326.7344 290.5938,326.2813 290.5938,325.8906 C290.5938,325.4375 290.2031,325.0469 289.7344,325.0469 C289.5156,325.0469 289.3125,325.125 289.125,325.3125 C288.6719,325.7969 288.6719,325.7969 288.4844,325.8906 C288.0625,326.1563 287.375,326.2813 286.6094,326.2813 C284.5625,326.2813 283.2656,325.1875 283.2656,323.4844 L283.2656,322.3906 C283.2656,320.6094 284.5156,319.2969 286.25,319.2969 C286.8281,319.2969 287.4375,319.4531 287.9063,319.7031 C288.3906,319.9844 288.5625,320.2031 288.6563,320.6094 C288.7188,321.0156 288.75,321.1406 288.8906,321.2656 C289.0313,321.4063 289.2656,321.5156 289.4844,321.5156 C289.75,321.5156 290.0156,321.375 290.1875,321.1563 C290.2969,321 290.3281,320.8125 290.3281,320.3906 L290.3281,318.9688 C290.3281,318.5313 290.3125,318.4063 290.2188,318.25 C290.0625,317.9844 289.7813,317.8438 289.4844,317.8438 C289.1875,317.8438 288.9844,317.9375 288.7656,318.25 L288.5938,318.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="306.75" y="327.3467">SumLayer</text><line style="stroke:#181818;stroke-width:0.5;" x1="240.5" x2="410.5" y1="338.5" y2="338.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="245.5" y="355.4951">nodes : List[SumNode]</text><line style="stroke:#181818;stroke-width:0.5;" x1="240.5" x2="410.5" y1="362.7969" y2="362.7969"/></g><!--MD5=[b0fd6754c4234098630b52d58e725e19]
class DispatchCache--><g id="elem_DispatchCache"><rect codeLine="48" fill="#F1F1F1" height="96.8906" id="DispatchCache" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="272" x="668.5" y="290"/><ellipse cx="746.25" cy="306" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M748.5938,301.6719 C747.6563,301.2344 747.0625,301.0938 746.1875,301.0938 C743.5625,301.0938 741.5625,303.1719 741.5625,305.8906 L741.5625,307.0156 C741.5625,309.5938 743.6719,311.4844 746.5625,311.4844 C747.7813,311.4844 748.9375,311.1875 749.6875,310.6406 C750.2656,310.2344 750.5938,309.7813 750.5938,309.3906 C750.5938,308.9375 750.2031,308.5469 749.7344,308.5469 C749.5156,308.5469 749.3125,308.625 749.125,308.8125 C748.6719,309.2969 748.6719,309.2969 748.4844,309.3906 C748.0625,309.6563 747.375,309.7813 746.6094,309.7813 C744.5625,309.7813 743.2656,308.6875 743.2656,306.9844 L743.2656,305.8906 C743.2656,304.1094 744.5156,302.7969 746.25,302.7969 C746.8281,302.7969 747.4375,302.9531 747.9063,303.2031 C748.3906,303.4844 748.5625,303.7031 748.6563,304.1094 C748.7188,304.5156 748.75,304.6406 748.8906,304.7656 C749.0313,304.9063 749.2656,305.0156 749.4844,305.0156 C749.75,305.0156 750.0156,304.875 750.1875,304.6563 C750.2969,304.5 750.3281,304.3125 750.3281,303.8906 L750.3281,302.4688 C750.3281,302.0313 750.3125,301.9063 750.2188,301.75 C750.0625,301.4844 749.7813,301.3438 749.4844,301.3438 C749.1875,301.3438 748.9844,301.4375 748.7656,301.75 L748.5938,301.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="766.75" y="310.8467">DispatchCache</text><line style="stroke:#181818;stroke-width:0.5;" x1="669.5" x2="939.5" y1="322" y2="322"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="674.5" y="338.9951">likelihood : Dict[Module, np.ndarray]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="674.5" y="355.292">scope : Dict[Module, np.ndarray]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242" x="674.5" y="371.5889">sample : Dict[Module, np.ndarray]</text><line style="stroke:#181818;stroke-width:0.5;" x1="669.5" x2="939.5" y1="378.8906" y2="378.8906"/></g><!--MD5=[207949f27b0044680e36beb8120e7a82]
class DispatchContext--><g id="elem_DispatchContext"><rect codeLine="54" fill="#F1F1F1" height="80.5938" id="DispatchContext" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="232" x="573.5" y="448"/><ellipse cx="623.75" cy="464" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M626.0938,459.6719 C625.1563,459.2344 624.5625,459.0938 623.6875,459.0938 C621.0625,459.0938 619.0625,461.1719 619.0625,463.8906 L619.0625,465.0156 C619.0625,467.5938 621.1719,469.4844 624.0625,469.4844 C625.2813,469.4844 626.4375,469.1875 627.1875,468.6406 C627.7656,468.2344 628.0938,467.7813 628.0938,467.3906 C628.0938,466.9375 627.7031,466.5469 627.2344,466.5469 C627.0156,466.5469 626.8125,466.625 626.625,466.8125 C626.1719,467.2969 626.1719,467.2969 625.9844,467.3906 C625.5625,467.6563 624.875,467.7813 624.1094,467.7813 C622.0625,467.7813 620.7656,466.6875 620.7656,464.9844 L620.7656,463.8906 C620.7656,462.1094 622.0156,460.7969 623.75,460.7969 C624.3281,460.7969 624.9375,460.9531 625.4063,461.2031 C625.8906,461.4844 626.0625,461.7031 626.1563,462.1094 C626.2188,462.5156 626.25,462.6406 626.3906,462.7656 C626.5313,462.9063 626.7656,463.0156 626.9844,463.0156 C627.25,463.0156 627.5156,462.875 627.6875,462.6563 C627.7969,462.5 627.8281,462.3125 627.8281,461.8906 L627.8281,460.4688 C627.8281,460.0313 627.8125,459.9063 627.7188,459.75 C627.5625,459.4844 627.2813,459.3438 626.9844,459.3438 C626.6875,459.3438 626.4844,459.4375 626.2656,459.75 L626.0938,459.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="644.25" y="468.8467">DispatchContext</text><line style="stroke:#181818;stroke-width:0.5;" x1="574.5" x2="804.5" y1="480" y2="480"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="579.5" y="496.9951">cache : DispatchCache</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="579.5" y="513.292">args : Dict[Module, np.ndarray]</text><line style="stroke:#181818;stroke-width:0.5;" x1="574.5" x2="804.5" y1="520.5938" y2="520.5938"/></g><!--MD5=[540ad19034418cbb219aa4b2bc3e4d03]
class SumNode--><g id="elem_SumNode"><rect codeLine="63" fill="#F1F1F1" height="48" id="SumNode" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="275.5" y="464.5"/><ellipse cx="290.5" cy="480.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M292.8438,476.1719 C291.9063,475.7344 291.3125,475.5938 290.4375,475.5938 C287.8125,475.5938 285.8125,477.6719 285.8125,480.3906 L285.8125,481.5156 C285.8125,484.0938 287.9219,485.9844 290.8125,485.9844 C292.0313,485.9844 293.1875,485.6875 293.9375,485.1406 C294.5156,484.7344 294.8438,484.2813 294.8438,483.8906 C294.8438,483.4375 294.4531,483.0469 293.9844,483.0469 C293.7656,483.0469 293.5625,483.125 293.375,483.3125 C292.9219,483.7969 292.9219,483.7969 292.7344,483.8906 C292.3125,484.1563 291.625,484.2813 290.8594,484.2813 C288.8125,484.2813 287.5156,483.1875 287.5156,481.4844 L287.5156,480.3906 C287.5156,478.6094 288.7656,477.2969 290.5,477.2969 C291.0781,477.2969 291.6875,477.4531 292.1563,477.7031 C292.6406,477.9844 292.8125,478.2031 292.9063,478.6094 C292.9688,479.0156 293,479.1406 293.1406,479.2656 C293.2813,479.4063 293.5156,479.5156 293.7344,479.5156 C294,479.5156 294.2656,479.375 294.4375,479.1563 C294.5469,479 294.5781,478.8125 294.5781,478.3906 L294.5781,476.9688 C294.5781,476.5313 294.5625,476.4063 294.4688,476.25 C294.3125,475.9844 294.0313,475.8438 293.7344,475.8438 C293.4375,475.8438 293.2344,475.9375 293.0156,476.25 L292.8438,476.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="304.5" y="485.3467">SumNode</text><line style="stroke:#181818;stroke-width:0.5;" x1="276.5" x2="374.5" y1="496.5" y2="496.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="276.5" x2="374.5" y1="504.5" y2="504.5"/></g><!--MD5=[de66e0bf3b5cf0679d45b5a314dc41c5]
class ProductNode--><g id="elem_ProductNode"><rect codeLine="68" fill="#F1F1F1" height="48" id="ProductNode" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="43" y="464.5"/><ellipse cx="58" cy="480.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M60.3438,476.1719 C59.4063,475.7344 58.8125,475.5938 57.9375,475.5938 C55.3125,475.5938 53.3125,477.6719 53.3125,480.3906 L53.3125,481.5156 C53.3125,484.0938 55.4219,485.9844 58.3125,485.9844 C59.5313,485.9844 60.6875,485.6875 61.4375,485.1406 C62.0156,484.7344 62.3438,484.2813 62.3438,483.8906 C62.3438,483.4375 61.9531,483.0469 61.4844,483.0469 C61.2656,483.0469 61.0625,483.125 60.875,483.3125 C60.4219,483.7969 60.4219,483.7969 60.2344,483.8906 C59.8125,484.1563 59.125,484.2813 58.3594,484.2813 C56.3125,484.2813 55.0156,483.1875 55.0156,481.4844 L55.0156,480.3906 C55.0156,478.6094 56.2656,477.2969 58,477.2969 C58.5781,477.2969 59.1875,477.4531 59.6563,477.7031 C60.1406,477.9844 60.3125,478.2031 60.4063,478.6094 C60.4688,479.0156 60.5,479.1406 60.6406,479.2656 C60.7813,479.4063 61.0156,479.5156 61.2344,479.5156 C61.5,479.5156 61.7656,479.375 61.9375,479.1563 C62.0469,479 62.0781,478.8125 62.0781,478.3906 L62.0781,476.9688 C62.0781,476.5313 62.0625,476.4063 61.9688,476.25 C61.8125,475.9844 61.5313,475.8438 61.2344,475.8438 C60.9375,475.8438 60.7344,475.9375 60.5156,476.25 L60.3438,476.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="72" y="485.3467">ProductNode</text><line style="stroke:#181818;stroke-width:0.5;" x1="44" x2="167" y1="496.5" y2="496.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="44" x2="167" y1="504.5" y2="504.5"/></g><!--MD5=[0417168d75c47ce8d429e9f7d7ecdd1e]
class SPN--><g id="elem_SPN"><rect fill="#F1F1F1" height="48" id="SPN" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="1259.5" y="464.5"/><ellipse cx="1274.5" cy="480.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1276.8438,476.1719 C1275.9063,475.7344 1275.3125,475.5938 1274.4375,475.5938 C1271.8125,475.5938 1269.8125,477.6719 1269.8125,480.3906 L1269.8125,481.5156 C1269.8125,484.0938 1271.9219,485.9844 1274.8125,485.9844 C1276.0313,485.9844 1277.1875,485.6875 1277.9375,485.1406 C1278.5156,484.7344 1278.8438,484.2813 1278.8438,483.8906 C1278.8438,483.4375 1278.4531,483.0469 1277.9844,483.0469 C1277.7656,483.0469 1277.5625,483.125 1277.375,483.3125 C1276.9219,483.7969 1276.9219,483.7969 1276.7344,483.8906 C1276.3125,484.1563 1275.625,484.2813 1274.8594,484.2813 C1272.8125,484.2813 1271.5156,483.1875 1271.5156,481.4844 L1271.5156,480.3906 C1271.5156,478.6094 1272.7656,477.2969 1274.5,477.2969 C1275.0781,477.2969 1275.6875,477.4531 1276.1563,477.7031 C1276.6406,477.9844 1276.8125,478.2031 1276.9063,478.6094 C1276.9688,479.0156 1277,479.1406 1277.1406,479.2656 C1277.2813,479.4063 1277.5156,479.5156 1277.7344,479.5156 C1278,479.5156 1278.2656,479.375 1278.4375,479.1563 C1278.5469,479 1278.5781,478.8125 1278.5781,478.3906 L1278.5781,476.9688 C1278.5781,476.5313 1278.5625,476.4063 1278.4688,476.25 C1278.3125,475.9844 1278.0313,475.8438 1277.7344,475.8438 C1277.4375,475.8438 1277.2344,475.9375 1277.0156,476.25 L1276.8438,476.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1288.5" y="485.3467">SPN</text><line style="stroke:#181818;stroke-width:0.5;" x1="1260.5" x2="1318.5" y1="496.5" y2="496.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1260.5" x2="1318.5" y1="504.5" y2="504.5"/></g><!--MD5=[2ae4bcd515457a80f1b14dd6bd1171b4]
class BN--><g id="elem_BN"><rect fill="#F1F1F1" height="48" id="BN" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="1172.5" y="464.5"/><ellipse cx="1187.5" cy="480.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1189.8438,476.1719 C1188.9063,475.7344 1188.3125,475.5938 1187.4375,475.5938 C1184.8125,475.5938 1182.8125,477.6719 1182.8125,480.3906 L1182.8125,481.5156 C1182.8125,484.0938 1184.9219,485.9844 1187.8125,485.9844 C1189.0313,485.9844 1190.1875,485.6875 1190.9375,485.1406 C1191.5156,484.7344 1191.8438,484.2813 1191.8438,483.8906 C1191.8438,483.4375 1191.4531,483.0469 1190.9844,483.0469 C1190.7656,483.0469 1190.5625,483.125 1190.375,483.3125 C1189.9219,483.7969 1189.9219,483.7969 1189.7344,483.8906 C1189.3125,484.1563 1188.625,484.2813 1187.8594,484.2813 C1185.8125,484.2813 1184.5156,483.1875 1184.5156,481.4844 L1184.5156,480.3906 C1184.5156,478.6094 1185.7656,477.2969 1187.5,477.2969 C1188.0781,477.2969 1188.6875,477.4531 1189.1563,477.7031 C1189.6406,477.9844 1189.8125,478.2031 1189.9063,478.6094 C1189.9688,479.0156 1190,479.1406 1190.1406,479.2656 C1190.2813,479.4063 1190.5156,479.5156 1190.7344,479.5156 C1191,479.5156 1191.2656,479.375 1191.4375,479.1563 C1191.5469,479 1191.5781,478.8125 1191.5781,478.3906 L1191.5781,476.9688 C1191.5781,476.5313 1191.5625,476.4063 1191.4688,476.25 C1191.3125,475.9844 1191.0313,475.8438 1190.7344,475.8438 C1190.4375,475.8438 1190.2344,475.9375 1190.0156,476.25 L1189.8438,476.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20" x="1201.5" y="485.3467">BN</text><line style="stroke:#181818;stroke-width:0.5;" x1="1173.5" x2="1223.5" y1="496.5" y2="496.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="1173.5" x2="1223.5" y1="504.5" y2="504.5"/></g><!--MD5=[fea0c87994cc0e6cff7f375e4fbefb9e]
reverse link Module to NestingModule--><g id="link_Module_NestingModule"><path codeLine="15" d="M555.583,64.424 C526.876,79.959 491.933,98.868 460.3,115.987 " fill="none" id="Module-backto-NestingModule" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="552.529,58.118,573.45,54.755,559.192,70.431,552.529,58.118" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4982a4d849352280d5237884273d8fd1]
reverse link Module to Placeholder--><g id="link_Module_Placeholder"><path codeLine="16" d="M594.455,73.608 C592.714,77.43 591.036,81.268 589.5,85 C559.136,158.785 531.099,247.779 516.039,297.984 " fill="none" id="Module-backto-Placeholder" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="588.338,70.175,603.308,55.179,600.957,76.238,588.338,70.175" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a103b1852e3e4994c1d924981decf2f9]
reverse link NestingModule to Placeholder--><g id="link_NestingModule_Placeholder"><path codeLine="17" d="M406.426,225.634 C423.819,249.607 444.918,276.536 463.234,297.966 " fill="none" id="NestingModule-backto-Placeholder" style="stroke:#181818;stroke-width:1.0;"/><ellipse cx="402.3507" cy="219.9234" fill="#FFFFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="406.9985" x2="397.703" y1="226.4348" y2="213.412"/><line style="stroke:#181818;stroke-width:1.0;" x1="395.8393" x2="408.8622" y1="224.5712" y2="215.2757"/></g><!--MD5=[527b40695e3941cfb2eaf25170657751]
link NestingModule to Placeholder--><g id="link_NestingModule_Placeholder"><path codeLine="18" d="M421.516,213.412 C442.613,238.594 466.024,269.237 482.872,293.771 " fill="none" id="NestingModule-to-Placeholder" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="485.728,297.966,483.9686,288.2756,482.9138,293.8332,477.3561,292.7784,485.728,297.966" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[11593aeea67b481ea398fcb3e5814276]
reverse link Module to LeafLayer--><g id="link_Module_LeafLayer"><path codeLine="26" d="M676.895,50.359 C707.894,60.003 745.947,72.413 779.5,85 C817.856,99.389 859.914,117.277 894.028,132.342 " fill="none" id="Module-backto-LeafLayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="674.722,57.015,657.661,44.448,678.835,43.633,674.722,57.015" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a5abba92ddf5fdafee846c7905d3cd4a]
link LeafLayer to LeafNode--><g id="link_LeafLayer_LeafNode"><path codeLine="27" d="M973.909,196.648 C985.689,228.81 1003.904,278.539 1015.24,309.495 " fill="none" id="LeafLayer-to-LeafNode" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1017,314.296,1017.6537,304.4689,1015.277,309.6022,1010.1437,307.2256,1017,314.296" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[998bb52771b8a2acef896b4427a515c3]
reverse link NetworkType to Scope--><g id="link_NetworkType_Scope"><path codeLine="34" d="M1167.63,365.906 C1141.02,388.672 1102.21,421.878 1071.86,447.8387 " fill="none" id="NetworkType-backto-Scope" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1171.47,362.625,1162.034,365.4468,1167.6743,365.8797,1167.2415,371.5199,1171.47,362.625" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c0c3b8cc5a68f06c53818c23e5d6de4d]
link LeafNode to Scope--><g id="link_LeafNode_Scope"><path codeLine="36" d="M1025.5,362.625 C1025.5,383.966 1025.5,416.248 1025.5,442.6432 " fill="none" id="LeafNode-to-Scope" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1025.5,447.8387,1029.5,438.8387,1025.5,442.8387,1021.5,438.8387,1025.5,447.8387" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4cceb9df4619d82ead3b905514076716]
link Module to DispatchCache--><g id="link_Module_DispatchCache"><path codeLine="59" d="M629.861,55.213 C660.701,105.062 733.795,223.213 774.976,289.777 " fill="none" id="Module-DispatchCache" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="727.5" y="169.0669">key</text></g><!--MD5=[313a0f2cc200a9cce5b550133e0e7194]
reverse link DispatchCache to DispatchContext--><g id="link_DispatchCache_DispatchContext"><path codeLine="60" d="M764.236,391.318 C749.809,409.885 733.787,430.5045 720.29,447.8752 " fill="none" id="DispatchCache-backto-DispatchContext" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="767.48,387.143,758.799,391.7949,764.4119,391.091,765.1158,396.7039,767.48,387.143" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e73d74dfc04bbe9808137fd4932ffa4]
link Module to DispatchContext--><g id="link_Module_DispatchContext"><path codeLine="61" d="M615.622,55.2 C616.387,112.395 621.25,264.412 650.5,387 C655.408,407.571 663.582,429.5632 671.183,447.7137 " fill="none" id="Module-DispatchContext" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="630.5" y="256.0669">key</text></g><!--MD5=[18aec7f8dab732d70d30b54687f2ccf3]
reverse link NestingModule to SumLayer--><g id="link_NestingModule_SumLayer"><path codeLine="65" d="M354.04,233.056 C347.122,258.372 339.593,285.925 334.006,306.372 " fill="none" id="NestingModule-backto-SumLayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="347.384,230.859,359.408,213.412,360.888,234.549,347.384,230.859" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bc62471d8c6f7411bee3e776944a3a3e]
link SumLayer to SumNode--><g id="link_SumLayer_SumNode"><path codeLine="66" d="M325.5,370.526 C325.5,396.64 325.5,433.6806 325.5,459.0428 " fill="none" id="SumLayer-to-SumNode" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="325.5,464.2695,329.5,455.2695,325.5,459.2695,321.5,455.2695,325.5,464.2695" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f42027253c9129ef76a4b547e1afd213]
reverse link NestingModule to ProductLayer--><g id="link_NestingModule_ProductLayer"><path codeLine="70" d="M281.53,224.103 C238.752,251.66 189.469,283.408 153.949,306.289 " fill="none" id="NestingModule-backto-ProductLayer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="277.876,218.13,298.48,213.183,285.458,229.899,277.876,218.13" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[468399379625fa666059c49bac5099cc]
link ProductLayer to ProductNode--><g id="link_ProductLayer_ProductNode"><path codeLine="71" d="M105.5,370.526 C105.5,396.64 105.5,433.6806 105.5,459.0428 " fill="none" id="ProductLayer-to-ProductNode" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="105.5,464.2695,109.5,455.2695,105.5,459.2695,101.5,455.2695,105.5,464.2695" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a0f50d086a4fc67c74a8886285c4ee65]
reverse link NetworkType to SPN--><g id="link_NetworkType_SPN"><path codeLine="74" d="M1223.32,379.868 C1239.93,406.875 1261.2,441.4736 1275.08,464.049 " fill="none" id="NetworkType-backto-SPN" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1217.23,383.329,1212.72,362.625,1229.16,375.996,1217.23,383.329" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8b3aa38a98d708493ec55897aeda3456]
reverse link NetworkType to BN--><g id="link_NetworkType_BN"><path codeLine="75" d="M1198.5,383.017 C1198.5,409.519 1198.5,442.3419 1198.5,464.049 " fill="none" id="NetworkType-backto-BN" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1191.5,382.625,1198.5,362.625,1205.5,382.625,1191.5,382.625" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[54585e50f19bcbc708fe70b82dd9c37e]
@startuml
abstract class Module

abstract class NestingModule {
  placeholders : List[Placeholder]
  - - -
  create_placeholder(...)
  set_placeholders(...)
}

class Placeholder {
  input_ids
  owner
}

Module <|- - NestingModule
Module <|- - Placeholder
NestingModule +- - Placeholder
NestingModule - -> Placeholder

class LeafLayer {
  nodes : List[LeafNode]
}

class LeafNode

Module <|- - LeafLayer
LeafLayer - -> LeafNode

class Scope {
  variables : Set[int]
  network_type : NetworkType
}

NetworkType <- - Scope

LeafNode - -> Scope

class ProductLayer {
  nodes : List[ProductNode]
}

class SumLayer {
  nodes : List[SumNode]
}

abstract class Module

class DispatchCache {
  likelihood : Dict[Module, np.ndarray]
  scope : Dict[Module, np.ndarray]
  sample : Dict[Module, np.ndarray]
}

class DispatchContext {
  cache : DispatchCache
  args : Dict[Module, np.ndarray]
}

Module - - - DispatchCache : key
DispatchCache <- - DispatchContext
Module - - - DispatchContext : key

class SumNode

NestingModule <|- - SumLayer
SumLayer - -> SumNode

class ProductNode

NestingModule <|- - ProductLayer
ProductLayer - -> ProductNode

abstract class  NetworkType
NetworkType <|- - SPN
NetworkType <|- - BN
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>